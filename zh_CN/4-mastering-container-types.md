# Python å·¥åŒ ï¼šå®¹å™¨çš„é—¨é“

## åºè¨€

> è¿™æ˜¯ â€œPython å·¥åŒ â€ç³»åˆ—çš„ç¬¬ 4 ç¯‡æ–‡ç« ã€‚[[æŸ¥çœ‹ç³»åˆ—æ‰€æœ‰æ–‡ç« ]](https://github.com/piglei/one-python-craftsman)

<div style="text-align: center; color: #999; margin: 14px 0 14px;font-size: 12px;">
<img src="https://www.zlovezl.cn/static//uploaded/2019/01/6002476959_cca2bf5424_b_thumb.jpg" width="100%" /><div>
å›¾ç‰‡æ¥æº: <a href="https://www.flickr.com/photos/chiotsrun/6002476959/in/photolist-a9qgh4-W4eQ1j-7MrCfo-4ARLWp-dwCzHh-Tascu9-RNRbRf-foLHW5-22dkkHM-9ceFA8-aGGd3a-26X3sqQ-iuTwX9-q52ktA-osn2eb-29oujY-6mXd1c-8E92nc-mPbq55-9GuPU8-26Q1NZG-8UL8PL-pdyFsW-7V8ifD-VZavJ8-2cUdHbU-9WrgjZ-6g7M5K-VMLVrb-cXDd4-bygFJG-C76kP-nMQW54-7MoQqn-qA3fud-c92dBU-tAzTBm-7KqFXc-24VvcW1-djQX9e-5LzjkA-63U4kb-bt1EEY-jLRpKo-dQSWBH-aDbqXc-8KhfnE-2m5ZsF-6ciuiR-qwdbt">"The Humble Mason Jar" by Chiot's Run</a> - éå•†ä¸šæ€§ä½¿ç”¨ 2.0 é€šç”¨</div>
</div>

å®¹å™¨â€è¿™ä¸¤ä¸ªå­—å¾ˆå°‘è¢« Python æŠ€æœ¯æ–‡ç« æèµ·ã€‚ä¸€çœ‹åˆ°â€œå®¹å™¨â€ï¼Œå¤§å®¶æƒ³åˆ°çš„å¤šæ˜¯é‚£å¤´è“è‰²å°é²¸é±¼ï¼š*Docker*ï¼Œä½†è¿™ç¯‡æ–‡ç« å’Œå®ƒæ²¡æœ‰ä»»ä½•å…³ç³»ã€‚æœ¬æ–‡é‡Œçš„å®¹å™¨ï¼Œæ˜¯ Python ä¸­çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œæ˜¯å¯¹**ä¸“é—¨ç”¨æ¥è£…å…¶ä»–å¯¹è±¡çš„æ•°æ®ç±»å‹**çš„ç»Ÿç§°ã€‚

åœ¨ Python ä¸­ï¼Œæœ‰å››ç±»æœ€å¸¸è§çš„å†…å»ºå®¹å™¨ç±»å‹ï¼š`åˆ—è¡¨ï¼ˆlistï¼‰`ã€`å…ƒç»„ï¼ˆtupleï¼‰`ã€`å­—å…¸ï¼ˆdictï¼‰`ã€`é›†åˆï¼ˆsetï¼‰`ã€‚é€šè¿‡å•ç‹¬æˆ–æ˜¯ç»„åˆä½¿ç”¨å®ƒä»¬ï¼Œå¯ä»¥é«˜æ•ˆçš„å®Œæˆå¾ˆå¤šäº‹æƒ…ã€‚

Python è¯­è¨€è‡ªèº«çš„å†…éƒ¨å®ç°ç»†èŠ‚ä¹Ÿä¸è¿™äº›å®¹å™¨ç±»å‹æ¯æ¯ç›¸å…³ã€‚æ¯”å¦‚ Python çš„ç±»å®ä¾‹å±æ€§ã€å…¨å±€å˜é‡ `globals()` ç­‰å°±éƒ½æ˜¯é€šè¿‡å­—å…¸ç±»å‹æ¥å­˜å‚¨çš„ã€‚

åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘é¦–å…ˆä¼šä»å®¹å™¨ç±»å‹çš„å®šä¹‰å‡ºå‘ï¼Œå°è¯•æ€»ç»“å‡ºä¸€äº›æ—¥å¸¸ç¼–ç çš„æœ€ä½³å®è·µã€‚ä¹‹åå†å›´ç»•å„ä¸ªå®¹å™¨ç±»å‹æä¾›çš„ç‰¹æ®Šæœºèƒ½ï¼Œåˆ†äº«ä¸€äº›ç¼–ç¨‹çš„å°æŠ€å·§ã€‚

### å†…å®¹ç›®å½•

* [åº•å±‚çœ‹å®¹å™¨](#åº•å±‚çœ‹å®¹å™¨)
    * [å†™æ›´å¿«çš„ä»£ç ](#å†™æ›´å¿«çš„ä»£ç )
        * [1. é¿å…é¢‘ç¹æ‰©å……åˆ—è¡¨/åˆ›å»ºæ–°åˆ—è¡¨](#1-é¿å…é¢‘ç¹æ‰©å……åˆ—è¡¨åˆ›å»ºæ–°åˆ—è¡¨)
        * [2. åœ¨åˆ—è¡¨å¤´éƒ¨æ“ä½œå¤šçš„åœºæ™¯ä½¿ç”¨ deque æ¨¡å—](#2-åœ¨åˆ—è¡¨å¤´éƒ¨æ“ä½œå¤šçš„åœºæ™¯ä½¿ç”¨-deque-æ¨¡å—)
        * [3. ä½¿ç”¨é›†åˆ/å­—å…¸æ¥åˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨](#3-ä½¿ç”¨é›†åˆå­—å…¸æ¥åˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨)
* [é«˜å±‚çœ‹å®¹å™¨](#é«˜å±‚çœ‹å®¹å™¨)
    * [å†™æ‰©å±•æ€§æ›´å¥½çš„ä»£ç ](#å†™æ‰©å±•æ€§æ›´å¥½çš„ä»£ç )
        * [é¢å‘å®¹å™¨æ¥å£ç¼–ç¨‹](#é¢å‘å®¹å™¨æ¥å£ç¼–ç¨‹)
* [å¸¸ç”¨æŠ€å·§](#å¸¸ç”¨æŠ€å·§)
    * [1. ä½¿ç”¨å…ƒç»„æ”¹å–„åˆ†æ”¯ä»£ç ](#1-ä½¿ç”¨å…ƒç»„æ”¹å–„åˆ†æ”¯ä»£ç )
    * [2. åœ¨æ›´å¤šåœ°æ–¹ä½¿ç”¨åŠ¨æ€è§£åŒ…](#2-åœ¨æ›´å¤šåœ°æ–¹ä½¿ç”¨åŠ¨æ€è§£åŒ…)
    * [3. ä½¿ç”¨ next() å‡½æ•°](#3-ä½¿ç”¨-next-å‡½æ•°)
    * [4. ä½¿ç”¨æœ‰åºå­—å…¸æ¥å»é‡](#4-ä½¿ç”¨æœ‰åºå­—å…¸æ¥å»é‡)
* [å¸¸è§è¯¯åŒº](#å¸¸è§è¯¯åŒº)
    * [1. å½“å¿ƒé‚£äº›å·²ç»æ¯ç«­çš„è¿­ä»£å™¨](#1-å½“å¿ƒé‚£äº›å·²ç»æ¯ç«­çš„è¿­ä»£å™¨)
    * [2. åˆ«åœ¨å¾ªç¯ä½“å†…ä¿®æ”¹è¢«è¿­ä»£å¯¹è±¡](#2-åˆ«åœ¨å¾ªç¯ä½“å†…ä¿®æ”¹è¢«è¿­ä»£å¯¹è±¡)
* [æ€»ç»“](#æ€»ç»“)
* [ç³»åˆ—å…¶ä»–æ–‡ç« ](#ç³»åˆ—å…¶ä»–æ–‡ç« )
* [æ³¨è§£](#æ³¨è§£)


### å½“æˆ‘ä»¬è°ˆè®ºå®¹å™¨æ—¶ï¼Œæˆ‘ä»¬åœ¨è°ˆäº›ä»€ä¹ˆï¼Ÿ

æˆ‘åœ¨å‰é¢ç»™äº†â€œå®¹å™¨â€ä¸€ä¸ªç®€å•çš„å®šä¹‰ï¼š*ä¸“é—¨ç”¨æ¥è£…å…¶ä»–å¯¹è±¡çš„å°±æ˜¯å®¹å™¨*ã€‚ä½†è¿™ä¸ªå®šä¹‰å¤ªå®½æ³›äº†ï¼Œæ— æ³•å¯¹æˆ‘ä»¬çš„æ—¥å¸¸ç¼–ç¨‹äº§ç”Ÿä»€ä¹ˆæŒ‡å¯¼ä»·å€¼ã€‚è¦çœŸæ­£æŒæ¡ Python é‡Œçš„å®¹å™¨ï¼Œéœ€è¦åˆ†åˆ«ä»ä¸¤ä¸ªå±‚é¢å…¥æ‰‹ï¼š

- **åº•å±‚å®ç°**ï¼šå†…ç½®å®¹å™¨ç±»å‹ä½¿ç”¨äº†ä»€ä¹ˆæ•°æ®ç»“æ„ï¼ŸæŸé¡¹æ“ä½œå¦‚ä½•å·¥ä½œï¼Ÿ
- **é«˜å±‚æŠ½è±¡**ï¼šä»€ä¹ˆå†³å®šäº†æŸä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯å®¹å™¨ï¼Ÿå“ªäº›è¡Œä¸ºå®šä¹‰äº†å®¹å™¨ï¼Ÿ

ä¸‹é¢ï¼Œè®©æˆ‘ä»¬ä¸€èµ·ç«™åœ¨è¿™ä¸¤ä¸ªä¸åŒçš„å±‚é¢ä¸Šï¼Œé‡æ–°è®¤è¯†å®¹å™¨ã€‚


## åº•å±‚çœ‹å®¹å™¨

Python æ˜¯ä¸€é—¨é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼Œ**å®ƒæ‰€æä¾›çš„å†…ç½®å®¹å™¨ç±»å‹ï¼Œéƒ½æ˜¯ç»è¿‡é«˜åº¦å°è£…å’ŒæŠ½è±¡åçš„ç»“æœ**ã€‚å’Œâ€œé“¾è¡¨â€ã€â€œçº¢é»‘æ ‘â€ã€â€œå“ˆå¸Œè¡¨â€è¿™äº›åå­—ç›¸æ¯”ï¼Œæ‰€æœ‰ Python å†…å»ºç±»å‹çš„åå­—ï¼Œéƒ½åªæè¿°äº†è¿™ä¸ªç±»å‹çš„åŠŸèƒ½ç‰¹ç‚¹ï¼Œå…¶ä»–äººå®Œå…¨æ²¡æ³•åªé€šè¿‡è¿™äº›åå­—äº†è§£å®ƒä»¬çš„å“ªæ€•ä¸€ä¸ç‚¹å†…éƒ¨ç»†èŠ‚ã€‚

è¿™æ˜¯ Python ç¼–ç¨‹è¯­è¨€çš„ä¼˜åŠ¿ä¹‹ä¸€ã€‚ç›¸æ¯” C è¯­è¨€è¿™ç±»æ›´æ¥è¿‘è®¡ç®—æœºåº•å±‚çš„ç¼–ç¨‹è¯­è¨€ï¼ŒPython é‡æ–°è®¾è®¡å¹¶å®ç°äº†å¯¹ç¼–ç¨‹è€…æ›´å‹å¥½çš„å†…ç½®å®¹å™¨ç±»å‹ï¼Œå±è”½æ‰äº†å†…å­˜ç®¡ç†ç­‰é¢å¤–å·¥ä½œã€‚ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¥½çš„å¼€å‘ä½“éªŒã€‚

ä½†å¦‚æœè¿™æ˜¯ Python è¯­è¨€çš„ä¼˜åŠ¿çš„è¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦è´¹åŠ²å»äº†è§£å®¹å™¨ç±»å‹çš„å®ç°ç»†èŠ‚å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼š**å…³æ³¨ç»†èŠ‚å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¼–å†™å‡ºæ›´å¿«çš„ä»£ç ã€‚**

### å†™æ›´å¿«çš„ä»£ç 

#### 1. é¿å…é¢‘ç¹æ‰©å……åˆ—è¡¨/åˆ›å»ºæ–°åˆ—è¡¨

æ‰€æœ‰çš„å†…å»ºå®¹å™¨ç±»å‹éƒ½ä¸é™åˆ¶å®¹é‡ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æŠŠé€’å¢çš„æ•°å­—ä¸æ–­å¡è¿›ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œæœ€ç»ˆæ’‘çˆ†æ•´å°æœºå™¨çš„å†…å­˜ã€‚

åœ¨ Python è¯­è¨€çš„å®ç°ç»†èŠ‚é‡Œï¼Œåˆ—è¡¨çš„å†…å­˜æ˜¯æŒ‰éœ€åˆ†é…çš„[[æ³¨1]](#annot1)ï¼Œå½“æŸä¸ªåˆ—è¡¨å½“å‰æ‹¥æœ‰çš„å†…å­˜ä¸å¤Ÿæ—¶ï¼Œä¾¿ä¼šè§¦å‘å†…å­˜æ‰©å®¹é€»è¾‘ã€‚è€Œåˆ†é…å†…å­˜æ˜¯ä¸€é¡¹æ˜‚è´µçš„æ“ä½œã€‚è™½ç„¶å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®ƒä¸ä¼šå¯¹ä½ çš„ç¨‹åºæ€§èƒ½äº§ç”Ÿä»€ä¹ˆä¸¥é‡çš„å½±å“ã€‚ä½†æ˜¯å½“ä½ å¤„ç†çš„æ•°æ®é‡ç‰¹åˆ«å¤§æ—¶ï¼Œå¾ˆå®¹æ˜“å› ä¸ºå†…å­˜åˆ†é…æ‹–ç´¯æ•´ä¸ªç¨‹åºçš„æ€§èƒ½ã€‚

è¿˜å¥½ï¼ŒPython æ—©å°±æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶æä¾›äº†å®˜æ–¹çš„é—®é¢˜è§£å†³æŒ‡å¼•ï¼Œé‚£å°±æ˜¯ï¼š**â€œå˜æ‡’â€**ã€‚

å¦‚ä½•è§£é‡Šâ€œå˜æ‡’â€ï¼Ÿ`range()` å‡½æ•°çš„è¿›åŒ–æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä¾‹å­ã€‚

åœ¨ Python 2 ä¸­ï¼Œå¦‚æœä½ è°ƒç”¨ `range(100000000)`ï¼Œéœ€è¦ç­‰å¾…å¥½å‡ ç§’æ‰èƒ½æ‹¿åˆ°ç»“æœï¼Œå› ä¸ºå®ƒéœ€è¦è¿”å›ä¸€ä¸ªå·¨å¤§çš„åˆ—è¡¨ï¼ŒèŠ±è´¹äº†éå¸¸å¤šçš„æ—¶é—´åœ¨å†…å­˜åˆ†é…ä¸è®¡ç®—ä¸Šã€‚ä½†åœ¨ Python 3 ä¸­ï¼ŒåŒæ ·çš„è°ƒç”¨é©¬ä¸Šå°±èƒ½æ‹¿åˆ°ç»“æœã€‚å› ä¸ºå‡½æ•°è¿”å›çš„ä¸å†æ˜¯åˆ—è¡¨ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»å‹ä¸º `range` çš„æ‡’æƒ°å¯¹è±¡ï¼Œåªæœ‰åœ¨ä½ è¿­ä»£å®ƒã€æˆ–æ˜¯å¯¹å®ƒè¿›è¡Œåˆ‡ç‰‡æ—¶ï¼Œå®ƒæ‰ä¼šè¿”å›çœŸæ­£çš„æ•°å­—ç»™ä½ ã€‚

**æ‰€ä»¥è¯´ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œå†…å»ºå‡½æ•° `range` â€œå˜æ‡’â€äº†ã€‚** è€Œä¸ºäº†é¿å…è¿‡äºé¢‘ç¹çš„å†…å­˜åˆ†é…ï¼Œåœ¨æ—¥å¸¸ç¼–ç ä¸­ï¼Œæˆ‘ä»¬çš„å‡½æ•°åŒæ ·ä¹Ÿéœ€è¦å˜æ‡’ï¼Œè¿™åŒ…æ‹¬ï¼š

- æ›´å¤šçš„ä½¿ç”¨ `yield` å…³é”®å­—ï¼Œè¿”å›ç”Ÿæˆå™¨å¯¹è±¡
- å°½é‡ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æ›¿ä»£åˆ—è¡¨æ¨å¯¼è¡¨è¾¾å¼
    - ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼š`(i for i in range(100))` ğŸ‘
    - åˆ—è¡¨æ¨å¯¼è¡¨è¾¾å¼ï¼š`[i for i in range(100)]`
- å°½é‡ä½¿ç”¨æ¨¡å—æä¾›çš„æ‡’æƒ°å¯¹è±¡ï¼š
    - ä½¿ç”¨ `re.finditer` æ›¿ä»£ `re.findall`
    - ç›´æ¥ä½¿ç”¨å¯è¿­ä»£çš„æ–‡ä»¶å¯¹è±¡ï¼š `for line in fp`ï¼Œè€Œä¸æ˜¯ `for line in fp.readlines()`

#### 2. åœ¨åˆ—è¡¨å¤´éƒ¨æ“ä½œå¤šçš„åœºæ™¯ä½¿ç”¨ deque æ¨¡å—

åˆ—è¡¨æ˜¯åŸºäºæ•°ç»„ç»“æ„ï¼ˆArrayï¼‰å®ç°çš„ï¼Œå½“ä½ åœ¨åˆ—è¡¨çš„å¤´éƒ¨æ’å…¥æ–°æˆå‘˜ï¼ˆ`list.insert(0, item)`ï¼‰æ—¶ï¼Œå®ƒåé¢çš„æ‰€æœ‰å…¶ä»–æˆå‘˜éƒ½éœ€è¦è¢«ç§»åŠ¨ï¼Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n)`ã€‚è¿™å¯¼è‡´åœ¨åˆ—è¡¨çš„å¤´éƒ¨æ’å…¥æˆå‘˜è¿œæ¯”åœ¨å°¾éƒ¨è¿½åŠ ï¼ˆ`list.append(item)` æ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼‰è¦æ…¢ã€‚

å¦‚æœä½ çš„ä»£ç éœ€è¦æ‰§è¡Œå¾ˆå¤šæ¬¡è¿™ç±»æ“ä½œï¼Œè¯·è€ƒè™‘ä½¿ç”¨ [collections.deque](https://docs.python.org/3.7/library/collections.html#collections.deque) ç±»å‹æ¥æ›¿ä»£åˆ—è¡¨ã€‚å› ä¸º deque æ˜¯åŸºäºåŒç«¯é˜Ÿåˆ—å®ç°çš„ï¼Œæ— è®ºæ˜¯åœ¨å¤´éƒ¨è¿˜æ˜¯å°¾éƒ¨è¿½åŠ å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ `O(1)`ã€‚

#### 3. ä½¿ç”¨é›†åˆ/å­—å…¸æ¥åˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨

å½“ä½ éœ€è¦åˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨äºæŸä¸ªå®¹å™¨æ—¶ï¼Œç”¨é›†åˆæ¯”åˆ—è¡¨æ›´åˆé€‚ã€‚å› ä¸º `item in [...]` æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n)`ï¼Œè€Œ `item in {...}` çš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(1)`ã€‚è¿™æ˜¯å› ä¸ºå­—å…¸ä¸é›†åˆéƒ½æ˜¯åŸºäºå“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰æ•°æ®ç»“æ„å®ç°çš„ã€‚

```python
# è¿™ä¸ªä¾‹å­ä¸æ˜¯ç‰¹åˆ«æ°å½“ï¼Œå› ä¸ºå½“ç›®æ ‡é›†åˆç‰¹åˆ«å°æ—¶ï¼Œä½¿ç”¨é›†åˆè¿˜æ˜¯åˆ—è¡¨å¯¹æ•ˆç‡çš„å½±å“å¾®ä¹å…¶å¾®
# ä½†è¿™ä¸æ˜¯é‡ç‚¹ :)
VALID_NAMES = ["piglei", "raymond", "bojack", "caroline"]

# è½¬æ¢ä¸ºé›†åˆç±»å‹ä¸“é—¨ç”¨äºæˆå‘˜åˆ¤æ–­
VALID_NAMES_SET = set(VALID_NAMES)


def validate_name(name):
    if name not in VALID_NAMES_SET:
        # æ­¤å¤„ä½¿ç”¨äº† Python 3.6 æ·»åŠ çš„ f-strings ç‰¹æ€§
        raise ValueError(f"{name} is not a valid name!")
```

> Hint: å¼ºçƒˆå»ºè®®é˜…è¯» [TimeComplexity - Python Wiki](https://wiki.python.org/moin/TimeComplexity)ï¼Œäº†è§£æ›´å¤šå…³äºå¸¸è§å®¹å™¨ç±»å‹çš„æ—¶é—´å¤æ‚åº¦ç›¸å…³å†…å®¹ã€‚
> 
> å¦‚æœä½ å¯¹å­—å…¸çš„å®ç°ç»†èŠ‚æ„Ÿå…´è¶£ï¼Œä¹Ÿå¼ºçƒˆå»ºè®®è§‚çœ‹ Raymond Hettinger çš„æ¼”è®² [Modern Dictionaries(YouTube)](https://www.youtube.com/watch?v=p33CVV29OG8&t=1403s)

## é«˜å±‚çœ‹å®¹å™¨

Python æ˜¯ä¸€é—¨â€œ[é¸­å­ç±»å‹](https://en.wikipedia.org/wiki/Duck_typing)â€è¯­è¨€ï¼š*â€œå½“çœ‹åˆ°ä¸€åªé¸Ÿèµ°èµ·æ¥åƒé¸­å­ã€æ¸¸æ³³èµ·æ¥åƒé¸­å­ã€å«èµ·æ¥ä¹Ÿåƒé¸­å­ï¼Œé‚£ä¹ˆè¿™åªé¸Ÿå°±å¯ä»¥è¢«ç§°ä¸ºé¸­å­ã€‚â€* æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬è¯´æŸä¸ªå¯¹è±¡æ˜¯ä»€ä¹ˆç±»å‹æ—¶ï¼Œåœ¨æ ¹æœ¬ä¸Šå…¶å®æŒ‡çš„æ˜¯ï¼š **è¿™ä¸ªå¯¹è±¡æ»¡è¶³äº†è¯¥ç±»å‹çš„ç‰¹å®šæ¥å£è§„èŒƒï¼Œå¯ä»¥è¢«å½“æˆè¿™ä¸ªç±»å‹æ¥ä½¿ç”¨ã€‚** è€Œå¯¹äºæ‰€æœ‰å†…ç½®å®¹å™¨ç±»å‹æ¥è¯´ï¼ŒåŒæ ·å¦‚æ­¤ã€‚

æ‰“å¼€ä½äº [collections](https://docs.python.org/3.7/library/collections.html) æ¨¡å—ä¸‹çš„ [abc](https://docs.python.org/3/library/collections.abc.html)*ï¼ˆâ€œæŠ½è±¡ç±» Abstract Base Classesâ€çš„é¦–å­—æ¯ç¼©å†™ï¼‰* å­æ¨¡å—ï¼Œå¯ä»¥æ‰¾åˆ°æ‰€æœ‰ä¸å®¹å™¨ç›¸å…³çš„æ¥å£ï¼ˆæŠ½è±¡ç±»ï¼‰[[æ³¨2]](#annot2)å®šä¹‰ã€‚è®©æˆ‘ä»¬åˆ†åˆ«çœ‹çœ‹é‚£äº›å†…å»ºå®¹å™¨ç±»å‹éƒ½æ»¡è¶³äº†ä»€ä¹ˆæ¥å£ï¼š

- **åˆ—è¡¨ï¼ˆlistï¼‰**ï¼šæ»¡è¶³ `Iterable`ã€`Sequence`ã€`MutableSequence` ç­‰æ¥å£
- **å…ƒç»„ï¼ˆtupleï¼‰**ï¼šæ»¡è¶³ `Iterable`ã€`Sequence`
- **å­—å…¸ï¼ˆdictï¼‰**ï¼šæ»¡è¶³ `Iterable`ã€`Mapping`ã€`MutableMapping` [[æ³¨3]](#annot3)
- **é›†åˆï¼ˆsetï¼‰**ï¼šæ»¡è¶³ `Iterable`ã€`Set`ã€`MutableSet` [[æ³¨4]](#annot4)

æ¯ä¸ªå†…ç½®å®¹å™¨ç±»å‹ï¼Œå…¶å®å°±æ˜¯æ»¡è¶³äº†å¤šä¸ªæ¥å£å®šä¹‰çš„ç»„åˆå®ä½“ã€‚æ¯”å¦‚æ‰€æœ‰çš„å®¹å™¨ç±»å‹éƒ½æ»¡è¶³ `â€œå¯è¢«è¿­ä»£çš„â€ï¼ˆIterable`ï¼‰ è¿™ä¸ªæ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒä»¬éƒ½æ˜¯â€œå¯è¢«è¿­ä»£â€çš„ã€‚ä½†æ˜¯åè¿‡æ¥ï¼Œä¸æ˜¯æ‰€æœ‰â€œå¯è¢«è¿­ä»£â€çš„å¯¹è±¡éƒ½æ˜¯å®¹å™¨ã€‚å°±åƒå­—ç¬¦ä¸²è™½ç„¶å¯ä»¥è¢«è¿­ä»£ï¼Œä½†æˆ‘ä»¬é€šå¸¸ä¸ä¼šæŠŠå®ƒå½“åšâ€œå®¹å™¨â€æ¥çœ‹å¾…ã€‚

äº†è§£è¿™ä¸ªäº‹å®åï¼Œæˆ‘ä»¬å°†**åœ¨ Python é‡Œé‡æ–°è®¤è¯†**é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­æœ€é‡è¦çš„åŸåˆ™ä¹‹ä¸€ï¼š**é¢å‘æ¥å£è€Œéå…·ä½“å®ç°æ¥ç¼–ç¨‹ã€‚**

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹å¦‚ä½•ç†è§£ Python é‡Œçš„â€œé¢å‘æ¥å£ç¼–ç¨‹â€ã€‚

### å†™æ‰©å±•æ€§æ›´å¥½çš„ä»£ç 

æŸæ—¥ï¼Œæˆ‘ä»¬æ¥åˆ°ä¸€ä¸ªéœ€æ±‚ï¼š*æœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢è£…ç€å¾ˆå¤šç”¨æˆ·è¯„è®ºï¼Œä¸ºäº†åœ¨é¡µé¢æ­£å¸¸å±•ç¤ºï¼Œéœ€è¦å°†æ‰€æœ‰è¶…è¿‡ä¸€å®šé•¿åº¦çš„è¯„è®ºç”¨çœç•¥å·æ›¿ä»£*ã€‚

è¿™ä¸ªéœ€æ±‚å¾ˆå¥½åšï¼Œå¾ˆå¿«æˆ‘ä»¬å°±å†™å‡ºäº†ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ä»£ç ï¼š

```python
# æ³¨ï¼šä¸ºäº†åŠ å¼ºç¤ºä¾‹ä»£ç çš„è¯´æ˜æ€§ï¼Œæœ¬æ–‡ä¸­çš„éƒ¨åˆ†ä»£ç ç‰‡æ®µä½¿ç”¨äº†Python 3.5
# ç‰ˆæœ¬æ·»åŠ çš„ Type Hinting ç‰¹æ€§

def add_ellipsis(comments: typing.List[str], max_length: int = 12):
    """å¦‚æœè¯„è®ºåˆ—è¡¨é‡Œçš„å†…å®¹è¶…è¿‡ max_lengthï¼Œå‰©ä¸‹çš„å­—ç¬¦ç”¨çœç•¥å·ä»£æ›¿
    """
    index = 0
    for comment in comments:
        comment = comment.strip()
        if len(comment) > max_length:
            comments[index] = comment[:max_length] + '...'
        index += 1
    return comments


comments = [
    "Implementation note",
    "Changed",
    "ABC for generator",
]
print("\n".join(add_ellipsis(comments)))
# OUTPUT:
# Implementati...
# Changed
# ABC for gene...
```

ä¸Šé¢çš„ä»£ç é‡Œï¼Œ`add_ellipsis` å‡½æ•°æ¥æ”¶ä¸€ä¸ªåˆ—è¡¨ä½œä¸ºå‚æ•°ï¼Œç„¶åéå†å®ƒï¼Œæ›¿æ¢æ‰éœ€è¦ä¿®æ”¹çš„æˆå‘˜ã€‚è¿™ä¸€åˆ‡çœ‹ä¸Šå»å¾ˆåˆç†ï¼Œå› ä¸ºæˆ‘ä»¬æ¥åˆ°çš„æœ€åŸå§‹éœ€æ±‚å°±æ˜¯ï¼šâ€œæœ‰ä¸€ä¸ª **åˆ—è¡¨**ï¼Œé‡Œé¢...â€ã€‚**ä½†å¦‚æœæœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬æ‹¿åˆ°çš„è¯„è®ºä¸å†æ˜¯è¢«ç»§ç»­è£…åœ¨åˆ—è¡¨é‡Œï¼Œè€Œæ˜¯åœ¨ä¸å¯å˜çš„å…ƒç»„é‡Œå‘¢ï¼Ÿ**

é‚£æ ·çš„è¯ï¼Œç°æœ‰çš„å‡½æ•°è®¾è®¡å°±ä¼šé€¼è¿«æˆ‘ä»¬å†™å‡º `add_ellipsis(list(comments))` è¿™ç§å³æ…¢åˆéš¾çœ‹çš„ä»£ç äº†ã€‚ğŸ˜¨

#### é¢å‘å®¹å™¨æ¥å£ç¼–ç¨‹

æˆ‘ä»¬éœ€è¦æ”¹è¿›å‡½æ•°æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚å› ä¸º `add_ellipsis` å‡½æ•°å¼ºä¾èµ–äº†åˆ—è¡¨ç±»å‹ï¼Œæ‰€ä»¥å½“å‚æ•°ç±»å‹å˜ä¸ºå…ƒç»„æ—¶ï¼Œç°åœ¨çš„å‡½æ•°å°±ä¸å†é€‚ç”¨äº†*ï¼ˆåŸå› ï¼šç»™ `comments[index]` èµ‹å€¼çš„åœ°æ–¹ä¼šæŠ›å‡º `TypeError` å¼‚å¸¸ï¼‰ã€‚* å¦‚ä½•æ”¹å–„è¿™éƒ¨åˆ†çš„è®¾è®¡ï¼Ÿç§˜è¯€å°±æ˜¯ï¼š**è®©å‡½æ•°ä¾èµ–â€œå¯è¿­ä»£å¯¹è±¡â€è¿™ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œè€Œéå®ä½“åˆ—è¡¨ç±»å‹ã€‚**

ä½¿ç”¨ç”Ÿæˆå™¨ç‰¹æ€§ï¼Œå‡½æ•°å¯ä»¥è¢«æ”¹æˆè¿™æ ·ï¼š

```python
def add_ellipsis_gen(comments: typing.Iterable[str], max_length: int = 12):
    """å¦‚æœå¯è¿­ä»£è¯„è®ºé‡Œçš„å†…å®¹è¶…è¿‡ max_lengthï¼Œå‰©ä¸‹çš„å­—ç¬¦ç”¨çœç•¥å·ä»£æ›¿
    """
    for comment in comments:
        comment = comment.strip()
        if len(comment) > max_length:
            yield comment[:max_length] + '...'
        else:
            yield comment


print("\n".join(add_ellipsis_gen(comments)))
```

åœ¨æ–°å‡½æ•°é‡Œï¼Œæˆ‘ä»¬å°†ä¾èµ–çš„å‚æ•°ç±»å‹ä»åˆ—è¡¨æ”¹æˆäº†å¯è¿­ä»£çš„æŠ½è±¡ç±»ã€‚è¿™æ ·åšæœ‰å¾ˆå¤šå¥½å¤„ï¼Œä¸€ä¸ªæœ€æ˜æ˜¾çš„å°±æ˜¯ï¼šæ— è®ºè¯„è®ºæ˜¯æ¥è‡ªåˆ—è¡¨ã€å…ƒç»„æˆ–æ˜¯æŸä¸ªæ–‡ä»¶ï¼Œæ–°å‡½æ•°éƒ½å¯ä»¥è½»æ¾æ»¡è¶³ï¼š

```python
# å¤„ç†æ”¾åœ¨å…ƒç»„é‡Œçš„è¯„è®º
comments = ("Implementation note", "Changed", "ABC for generator")
print("\n".join(add_ellipsis_gen(comments)))

# å¤„ç†æ”¾åœ¨æ–‡ä»¶é‡Œçš„è¯„è®º
with open("comments") as fp:
    for comment in add_ellipsis_gen(fp):
        print(comment)
```

å°†ä¾èµ–ç”±æŸä¸ªå…·ä½“çš„å®¹å™¨ç±»å‹æ”¹ä¸ºæŠ½è±¡æ¥å£åï¼Œå‡½æ•°çš„é€‚ç”¨é¢å˜å¾—æ›´å¹¿äº†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ–°å‡½æ•°åœ¨æ‰§è¡Œæ•ˆç‡ç­‰æ–¹é¢ä¹Ÿéƒ½æ›´æœ‰ä¼˜åŠ¿ã€‚ç°åœ¨è®©æˆ‘ä»¬å†å›åˆ°ä¹‹å‰çš„é—®é¢˜ã€‚**ä»é«˜å±‚æ¥çœ‹ï¼Œä»€ä¹ˆå®šä¹‰äº†å®¹å™¨ï¼Ÿ**

ç­”æ¡ˆæ˜¯ï¼š **å„ä¸ªå®¹å™¨ç±»å‹å®ç°çš„æ¥å£åè®®å®šä¹‰äº†å®¹å™¨ã€‚** ä¸åŒçš„å®¹å™¨ç±»å‹åœ¨æˆ‘ä»¬çš„çœ¼é‡Œï¼Œåº”è¯¥æ˜¯ `æ˜¯å¦å¯ä»¥è¿­ä»£`ã€`æ˜¯å¦å¯ä»¥ä¿®æ”¹`ã€`æœ‰æ²¡æœ‰é•¿åº¦` ç­‰å„ç§ç‰¹æ€§çš„ç»„åˆã€‚æˆ‘ä»¬éœ€è¦åœ¨ç¼–å†™ç›¸å…³ä»£ç æ—¶ï¼Œ**æ›´å¤šçš„å…³æ³¨å®¹å™¨çš„æŠ½è±¡å±æ€§ï¼Œè€Œéå®¹å™¨ç±»å‹æœ¬èº«**ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´ä¼˜é›…ã€æ‰©å±•æ€§æ›´å¥½çš„ä»£ç ã€‚

> Hintï¼šåœ¨ [itertools](https://docs.python.org/3/library/itertools.html) ä¸ [more-itertools](https://pypi.org/project/more-itertools/) æ¨¡å—é‡Œå¯ä»¥æ‰¾åˆ°æ›´å¤šå…³äºå¤„ç†å¯è¿­ä»£å¯¹è±¡çš„å®è—ã€‚

## å¸¸ç”¨æŠ€å·§

### 1. ä½¿ç”¨å…ƒç»„æ”¹å–„åˆ†æ”¯ä»£ç 

æœ‰æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç é‡Œä¼šå‡ºç°è¶…è¿‡ä¸‰ä¸ªåˆ†æ”¯çš„ `if/else` ã€‚å°±åƒä¸‹é¢è¿™æ ·ï¼š

```python
import time


def from_now(ts):
    """æ¥æ”¶ä¸€ä¸ªè¿‡å»çš„æ—¶é—´æˆ³ï¼Œè¿”å›è·ç¦»å½“å‰æ—¶é—´çš„ç›¸å¯¹æ—¶é—´æ–‡å­—æè¿°
    """
    now = time.time()
    seconds_delta = int(now - ts)
    if seconds_delta < 1:
        return "less than 1 second ago"
    elif seconds_delta < 60:
        return "{} seconds ago".format(seconds_delta)
    elif seconds_delta < 3600:
        return "{} minutes ago".format(seconds_delta // 60)
    elif seconds_delta < 3600 * 24:
        return "{} hours ago".format(seconds_delta // 3600)
    else:
        return "{} days ago".format(seconds_delta // (3600 * 24))


now = time.time()
print(from_now(now))
print(from_now(now - 24))
print(from_now(now - 600))
print(from_now(now - 7500))
print(from_now(now - 87500))
# OUTPUT:
# less than 1 second ago
# 24 seconds ago
# 10 minutes ago
# 2 hours ago
# 1 days ago
```

ä¸Šé¢è¿™ä¸ªå‡½æ•°æŒ‘ä¸å‡ºå¤ªå¤šæ¯›ç—…ï¼Œå¾ˆå¤šå¾ˆå¤šäººéƒ½ä¼šå†™å‡ºç±»ä¼¼çš„ä»£ç ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä»”ç»†è§‚å¯Ÿå®ƒï¼Œå¯ä»¥åœ¨åˆ†æ”¯ä»£ç éƒ¨åˆ†æ‰¾åˆ°ä¸€äº›æ˜æ˜¾çš„â€œ**è¾¹ç•Œ**â€ã€‚ æ¯”å¦‚ï¼Œå½“å‡½æ•°åˆ¤æ–­æŸä¸ªæ—¶é—´æ˜¯å¦åº”è¯¥ç”¨â€œç§’æ•°â€å±•ç¤ºæ—¶ï¼Œç”¨åˆ°äº† `60`ã€‚è€Œåˆ¤æ–­æ˜¯å¦åº”è¯¥ç”¨åˆ†é’Ÿæ—¶ï¼Œç”¨åˆ°äº† `3600`ã€‚

**ä»è¾¹ç•Œæç‚¼è§„å¾‹æ˜¯ä¼˜åŒ–è¿™æ®µä»£ç çš„å…³é”®ã€‚** å¦‚æœæˆ‘ä»¬å°†æ‰€æœ‰çš„è¿™äº›è¾¹ç•Œæ”¾åœ¨ä¸€ä¸ªæœ‰åºå…ƒç»„ä¸­ï¼Œç„¶åé…åˆäºŒåˆ†æŸ¥æ‰¾æ¨¡å— [bisect](https://docs.python.org/3.7/library/bisect.html)ã€‚æ•´ä¸ªå‡½æ•°çš„æ§åˆ¶æµå°±èƒ½è¢«å¤§å¤§ç®€åŒ–ï¼š

```python
import bisect


# BREAKPOINTS å¿…é¡»æ˜¯å·²ç»æ’å¥½åºçš„ï¼Œä¸ç„¶æ— æ³•è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾
BREAKPOINTS = (1, 60, 3600, 3600 * 24)
TMPLS = (
    # unit, template
    (1, "less than 1 second ago"),
    (1, "{units} seconds ago"),
    (60, "{units} minutes ago"),
    (3600, "{units} hours ago"),
    (3600 * 24, "{units} days ago"),
)


def from_now(ts):
    """æ¥æ”¶ä¸€ä¸ªè¿‡å»çš„æ—¶é—´æˆ³ï¼Œè¿”å›è·ç¦»å½“å‰æ—¶é—´çš„ç›¸å¯¹æ—¶é—´æ–‡å­—æè¿°
    """
    seconds_delta = int(time.time() - ts)
    unit, tmpl = TMPLS[bisect.bisect(BREAKPOINTS, seconds_delta)]
    return tmpl.format(units=seconds_delta // unit)
```

é™¤äº†ç”¨å…ƒç»„å¯ä»¥ä¼˜åŒ–è¿‡å¤šçš„ `if/else` åˆ†æ”¯å¤–ï¼Œæœ‰äº›æƒ…å†µä¸‹å­—å…¸ä¹Ÿèƒ½è¢«ç”¨æ¥åšåŒæ ·çš„äº‹æƒ…ã€‚å…³é”®åœ¨äºä»ç°æœ‰ä»£ç æ‰¾åˆ°é‡å¤çš„é€»è¾‘ä¸è§„å¾‹ï¼Œå¹¶å¤šå¤šå°è¯•ã€‚

### 2. åœ¨æ›´å¤šåœ°æ–¹ä½¿ç”¨åŠ¨æ€è§£åŒ…

åŠ¨æ€è§£åŒ…æ“ä½œæ˜¯æŒ‡ä½¿ç”¨ `*` æˆ– `**` è¿ç®—ç¬¦å°†å¯è¿­ä»£å¯¹è±¡â€œè§£å¼€â€çš„è¡Œä¸ºï¼Œåœ¨ Python 2 æ—¶ä»£ï¼Œè¿™ä¸ªæ“ä½œåªèƒ½è¢«ç”¨åœ¨å‡½æ•°å‚æ•°éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯¹å‡ºç°é¡ºåºå’Œæ•°é‡éƒ½æœ‰éå¸¸ä¸¥æ ¼çš„è¦æ±‚ï¼Œä½¿ç”¨åœºæ™¯éå¸¸å•ä¸€ã€‚

```python
def calc(a, b, multiplier=1):
    return (a + b) * multiplier


# Python2 ä¸­åªæ”¯æŒåœ¨å‡½æ•°å‚æ•°éƒ¨åˆ†è¿›è¡ŒåŠ¨æ€è§£åŒ…
print calc(*[1, 2], **{"multiplier": 10})
# OUTPUT: 30
```

ä¸è¿‡ï¼ŒPython 3 å°¤å…¶æ˜¯ 3.5 ç‰ˆæœ¬åï¼Œ`*` å’Œ `**` çš„ä½¿ç”¨åœºæ™¯è¢«å¤§å¤§æ‰©å……äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Python 2 ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åˆå¹¶ä¸¤ä¸ªå­—å…¸ï¼Œéœ€è¦è¿™ä¹ˆåšï¼š

```python
def merge_dict(d1, d2):
    # å› ä¸ºå­—å…¸æ˜¯å¯è¢«ä¿®æ”¹çš„å¯¹è±¡ï¼Œä¸ºäº†é¿å…ä¿®æ”¹åŸå¯¹è±¡ï¼Œæ­¤å¤„éœ€è¦å¤åˆ¶ä¸€ä¸ª d1 çš„æµ…æ‹·è´
    result = d1.copy()
    result.update(d2)
    return result
    
user = merge_dict({"name": "piglei"}, {"movies": ["Fight Club"]})
```

ä½†æ˜¯åœ¨ Python 3.5 ä»¥åçš„ç‰ˆæœ¬ï¼Œä½ å¯ä»¥ç›´æ¥ç”¨ `**` è¿ç®—ç¬¦æ¥å¿«é€Ÿå®Œæˆå­—å…¸çš„åˆå¹¶æ“ä½œï¼š

```
user = {**{"name": "piglei"}, **{"movies": ["Fight Club"]}}
```

é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥åœ¨æ™®é€šèµ‹å€¼è¯­å¥ä¸­ä½¿ç”¨ `*` è¿ç®—ç¬¦æ¥åŠ¨æ€çš„è§£åŒ…å¯è¿­ä»£å¯¹è±¡ã€‚å¦‚æœä½ æƒ³è¯¦ç»†äº†è§£ç›¸å…³å†…å®¹ï¼Œå¯ä»¥é˜…è¯»ä¸‹é¢æ¨èçš„ PEPã€‚

> Hintï¼šæ¨è¿›åŠ¨æ€è§£åŒ…åœºæ™¯æ‰©å……çš„ä¸¤ä¸ª PEPï¼š
> - [PEP 3132 -- Extended Iterable Unpacking | Python.org](https://www.python.org/dev/peps/pep-3132/)
> - [PEP 448 -- Additional Unpacking Generalizations | Python.org](https://www.python.org/dev/peps/pep-0448/)

### 3. ä½¿ç”¨ next() å‡½æ•°

`next()` æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å†…å»ºå‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªè¿­ä»£å™¨ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›è¯¥è¿­ä»£å™¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ä½¿ç”¨å®ƒé…åˆç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œå¯ä»¥é«˜æ•ˆçš„å®ç°*â€œä»åˆ—è¡¨ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æˆå‘˜â€* ä¹‹ç±»çš„éœ€æ±‚ã€‚

```python
numbers = [3, 7, 8, 2, 21]
# è·å–å¹¶ **ç«‹å³è¿”å›** åˆ—è¡¨é‡Œçš„ç¬¬ä¸€ä¸ªå¶æ•°
print(next(i for i in numbers if i % 2 == 0))
# OUTPUT: 8
```

### 4. ä½¿ç”¨æœ‰åºå­—å…¸æ¥å»é‡

å­—å…¸å’Œé›†åˆçš„ç»“æ„ç‰¹ç‚¹ä¿è¯äº†å®ƒä»¬çš„æˆå‘˜ä¸ä¼šé‡å¤ï¼Œæ‰€ä»¥å®ƒä»¬ç»å¸¸è¢«ç”¨æ¥å»é‡ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨å®ƒä»¬ä¿©å»é‡åçš„ç»“æœä¼šä¸¢å¤±åŸæœ‰åˆ—è¡¨çš„é¡ºåºã€‚è¿™æ˜¯ç”±åº•å±‚æ•°æ®ç»“æ„â€œå“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰â€çš„ç‰¹ç‚¹å†³å®šçš„ã€‚

```python
>>> l = [10, 2, 3, 21, 10, 3]
# å»é‡ä½†æ˜¯ä¸¢å¤±äº†é¡ºåº
>>> set(l)
{3, 10, 2, 21}
```

å¦‚æœæ—¢éœ€è¦å»é‡åˆå¿…é¡»ä¿ç•™é¡ºåºæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `collections.OrderedDict` æ¨¡å—:

```python
>>> from collections import OrderedDict
>>> list(OrderedDict.fromkeys(l).keys())
[10, 2, 3, 21]
```

> Hint: åœ¨ Python 3.6 ä¸­ï¼Œé»˜è®¤çš„å­—å…¸ç±»å‹ä¿®æ”¹äº†å®ç°æ–¹å¼ï¼Œå·²ç»å˜æˆæœ‰åºçš„äº†ã€‚å¹¶ä¸”åœ¨ Python 3.7 ä¸­ï¼Œè¯¥åŠŸèƒ½å·²ç»ä» **è¯­è¨€çš„å®ç°ç»†èŠ‚** å˜æˆäº†ä¸º **å¯ä¾èµ–çš„æ­£å¼è¯­è¨€ç‰¹æ€§**ã€‚
> 
> ä½†æ˜¯æˆ‘è§‰å¾—è®©æ•´ä¸ª Python ç¤¾åŒºä¹ æƒ¯è¿™ä¸€ç‚¹è¿˜éœ€è¦ä¸€äº›æ—¶é—´ï¼Œæ¯•ç«Ÿç›®å‰â€œå­—å…¸æ˜¯æ— åºçš„â€è¿˜æ˜¯è¢«å°åœ¨æ— æ•°æœ¬ Python ä¹¦ä¸Šã€‚æ‰€ä»¥ï¼Œæˆ‘ä»ç„¶å»ºè®®åœ¨ä¸€åˆ‡éœ€è¦æœ‰åºå­—å…¸çš„åœ°æ–¹ä½¿ç”¨ OrderedDictã€‚

## å¸¸è§è¯¯åŒº

### 1. å½“å¿ƒé‚£äº›å·²ç»æ¯ç«­çš„è¿­ä»£å™¨

åœ¨æ–‡ç« å‰é¢ï¼Œæˆ‘ä»¬æåˆ°äº†ä½¿ç”¨â€œæ‡’æƒ°â€ç”Ÿæˆå™¨çš„ç§ç§å¥½å¤„ã€‚ä½†æ˜¯ï¼Œæ‰€æœ‰äº‹ç‰©éƒ½æœ‰å®ƒçš„ä¸¤é¢æ€§ã€‚ç”Ÿæˆå™¨çš„æœ€å¤§çš„ç¼ºç‚¹ä¹‹ä¸€å°±æ˜¯ï¼š**å®ƒä¼šæ¯ç«­**ã€‚å½“ä½ å®Œæ•´éå†è¿‡å®ƒä»¬åï¼Œä¹‹åçš„é‡å¤éå†å°±ä¸èƒ½æ‹¿åˆ°ä»»ä½•æ–°å†…å®¹äº†ã€‚

```python
numbers = [1, 2, 3]
numbers = (i * 2 for i in numbers)

# ç¬¬ä¸€æ¬¡å¾ªç¯ä¼šè¾“å‡º 2, 4, 6
for number in numbers:
    print(number)

# è¿™æ¬¡å¾ªç¯ä»€ä¹ˆéƒ½ä¸ä¼šè¾“å‡ºï¼Œå› ä¸ºè¿­ä»£å™¨å·²ç»æ¯ç«­äº†
for number in numbers:
    print(number)
```

è€Œä¸”ä¸å…‰æ˜¯ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼ŒPython 3 é‡Œçš„ mapã€filter å†…å»ºå‡½æ•°ä¹Ÿéƒ½æœ‰ä¸€æ ·çš„ç‰¹ç‚¹ã€‚å¿½è§†è¿™ä¸ªç‰¹ç‚¹å¾ˆå®¹æ˜“å¯¼è‡´ä»£ç ä¸­å‡ºç°ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„ Bugã€‚

Instagram å°±åœ¨é¡¹ç›®ä» Python 2 åˆ° Python 3 çš„è¿ç§»è¿‡ç¨‹ä¸­ç¢°åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚å®ƒä»¬åœ¨ PyCon 2017 ä¸Šåˆ†äº«äº†å¯¹ä»˜è¿™ä¸ªé—®é¢˜çš„æ•…äº‹ã€‚è®¿é—®æ–‡ç«  [Instagram åœ¨ PyCon 2017 çš„æ¼”è®²æ‘˜è¦](https://www.zlovezl.cn/articles/instagram-pycon-2017/)ï¼Œæœç´¢â€œè¿­ä»£å™¨â€å¯ä»¥æŸ¥çœ‹è¯¦ç»†å†…å®¹ã€‚

### 2. åˆ«åœ¨å¾ªç¯ä½“å†…ä¿®æ”¹è¢«è¿­ä»£å¯¹è±¡

è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤š Python åˆå­¦è€…ä¼šçŠ¯çš„é”™è¯¯ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥åˆ æ‰åˆ—è¡¨é‡Œçš„æ‰€æœ‰å¶æ•°ï¼š

```python
def remove_even(numbers):
    """å»æ‰åˆ—è¡¨é‡Œæ‰€æœ‰çš„å¶æ•°
    """
    for i, number in enumerate(numbers):
        if number % 2 == 0:
            # æœ‰é—®é¢˜çš„ä»£ç 
            del numbers[i]


numbers = [1, 2, 7, 4, 8, 11]
remove_even(numbers)
print(numbers)
# OUTPUT: [1, 7, 8, 11]
```

æ³¨æ„åˆ°ç»“æœé‡Œé‚£ä¸ªå¤šå‡ºæ¥çš„ â€œ8â€ äº†å—ï¼Ÿå½“ä½ åœ¨éå†ä¸€ä¸ªåˆ—è¡¨çš„åŒæ—¶ä¿®æ”¹å®ƒï¼Œå°±ä¼šå‡ºç°è¿™æ ·çš„äº‹æƒ…ã€‚å› ä¸ºè¢«è¿­ä»£çš„å¯¹è±¡ `numbers` åœ¨å¾ªç¯è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹äº†ã€‚**éå†çš„ä¸‹æ ‡åœ¨ä¸æ–­å¢é•¿ï¼Œè€Œåˆ—è¡¨æœ¬èº«çš„é•¿åº¦åŒæ—¶åˆåœ¨ä¸æ–­ç¼©å‡ã€‚è¿™æ ·å°±ä¼šå¯¼è‡´åˆ—è¡¨é‡Œçš„ä¸€äº›æˆå‘˜å…¶å®æ ¹æœ¬å°±æ²¡æœ‰è¢«éå†åˆ°ã€‚**

æ‰€ä»¥å¯¹äºè¿™ç±»æ“ä½œï¼Œè¯·ä½¿ç”¨ä¸€ä¸ªæ–°çš„ç©ºåˆ—è¡¨ä¿å­˜ç»“æœï¼Œæˆ–è€…åˆ©ç”¨ `yield` è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ã€‚è€Œä¸æ˜¯ä¿®æ”¹è¢«è¿­ä»£çš„åˆ—è¡¨æˆ–æ˜¯å­—å…¸å¯¹è±¡æœ¬èº«ã€‚

## æ€»ç»“

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»â€œå®¹å™¨ç±»å‹â€çš„å®šä¹‰å‡ºå‘ï¼Œåœ¨åº•å±‚å’Œé«˜å±‚ä¸¤ä¸ªå±‚é¢æ¢è®¨äº†å®¹å™¨ç±»å‹ã€‚ä¹‹åéµå¾ªç³»åˆ—æ–‡ç« ä¼ ç»Ÿï¼Œæä¾›äº†ä¸€äº›ç¼–å†™å®¹å™¨ç›¸å…³ä»£ç æ—¶çš„æŠ€å·§ã€‚

è®©æˆ‘ä»¬æœ€åå†æ€»ç»“ä¸€ä¸‹è¦ç‚¹ï¼š

- äº†è§£å®¹å™¨ç±»å‹çš„åº•å±‚å®ç°ï¼Œå¯ä»¥å¸®åŠ©ä½ å†™å‡ºæ€§èƒ½æ›´å¥½çš„ä»£ç 
- æç‚¼éœ€æ±‚é‡Œçš„æŠ½è±¡æ¦‚å¿µï¼Œé¢å‘æ¥å£è€Œéå®ç°ç¼–ç¨‹
- å¤šä½¿ç”¨â€œæ‡’æƒ°â€çš„å¯¹è±¡ï¼Œå°‘ç”Ÿæˆâ€œè¿«åˆ‡â€çš„åˆ—è¡¨
- ä½¿ç”¨å…ƒç»„å’Œå­—å…¸å¯ä»¥ç®€åŒ–åˆ†æ”¯ä»£ç ç»“æ„
- ä½¿ç”¨ `next()` å‡½æ•°é…åˆè¿­ä»£å™¨å¯ä»¥é«˜æ•ˆå®Œæˆå¾ˆå¤šäº‹æƒ…ï¼Œä½†æ˜¯ä¹Ÿéœ€è¦æ³¨æ„â€œæ¯ç«­â€é—®é¢˜
- collectionsã€itertools æ¨¡å—é‡Œæœ‰éå¸¸å¤šæœ‰ç”¨çš„å·¥å…·ï¼Œå¿«å»çœ‹çœ‹å§ï¼

çœ‹å®Œæ–‡ç« çš„ä½ ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæƒ³åæ§½çš„ï¼Ÿè¯·ç•™è¨€æˆ–è€…åœ¨ [é¡¹ç›® Github Issues](https://github.com/piglei/one-python-craftsman) å‘Šè¯‰æˆ‘å§ã€‚

[>>>ä¸‹ä¸€ç¯‡ã€5.è®©å‡½æ•°è¿”å›ç»“æœçš„æŠ€å·§ã€‘](5-function-returning-tips.md)

[<<<ä¸Šä¸€ç¯‡ã€3.ä½¿ç”¨æ•°å­—ä¸å­—ç¬¦ä¸²çš„æŠ€å·§ã€‘](3-tips-on-numbers-and-strings.md)

## ç³»åˆ—å…¶ä»–æ–‡ç« 

- [æ‰€æœ‰æ–‡ç« ç´¢å¼• [Github]](https://github.com/piglei/one-python-craftsman)
- [Python å·¥åŒ ï¼šå–„ç”¨å˜é‡æ”¹å–„ä»£ç è´¨é‡](https://www.zlovezl.cn/articles/python-using-variables-well/)
- [Python å·¥åŒ ï¼šç¼–å†™æ¡ä»¶åˆ†æ”¯ä»£ç çš„æŠ€å·§](https://www.zlovezl.cn/articles/python-else-block-secrets/)
- [Python å·¥åŒ ï¼šä½¿ç”¨æ•°å­—ä¸å­—ç¬¦ä¸²çš„æŠ€å·§](https://www.zlovezl.cn/articles/tips-on-numbers-and-strings/)

## æ³¨è§£

1. <a id="annot1"></a>Python è¿™é—¨è¯­è¨€é™¤äº† CPython å¤–ï¼Œè¿˜æœ‰è®¸è®¸å¤šå¤šçš„å…¶ä»–ç‰ˆæœ¬å®ç°ã€‚å¦‚æ— ç‰¹åˆ«è¯´æ˜ï¼Œæœ¬æ–‡ä»¥åŠ â€œPython å·¥åŒ â€ ç³»åˆ—é‡Œå‡ºç°çš„æ‰€æœ‰ Python éƒ½ç‰¹æŒ‡ Python çš„ C è¯­è¨€å®ç° CPython
2. <a id="annot2"></a>Python é‡Œæ²¡æœ‰ç±»ä¼¼å…¶ä»–ç¼–ç¨‹è¯­è¨€é‡Œçš„â€œInterface æ¥å£â€ç±»å‹ï¼Œåªæœ‰ç±»ä¼¼çš„â€œæŠ½è±¡ç±»â€æ¦‚å¿µã€‚ä¸ºäº†è¡¨è¾¾æ–¹ä¾¿ï¼Œåé¢çš„å†…å®¹å‡ç»Ÿä¸€ä½¿ç”¨â€œæ¥å£â€æ¥æ›¿ä»£â€œæŠ½è±¡ç±»â€ã€‚
3. <a id="annot3"></a>æœ‰æ²¡æœ‰åªå®ç°äº† Mapping ä½†åˆä¸æ˜¯ MutableMapping çš„ç±»å‹ï¼Ÿè¯•è¯• [MappingProxyType({})](https://docs.python.org/3/library/types.html#types.MappingProxyType)
4. <a id="annot4"></a>æœ‰æ²¡æœ‰åªå®ç°äº† Set ä½†åˆä¸æ˜¯ MutableSet çš„ç±»å‹ï¼Ÿè¯•è¯• [frozenset()](https://docs.python.org/3/library/stdtypes.html#frozenset)

